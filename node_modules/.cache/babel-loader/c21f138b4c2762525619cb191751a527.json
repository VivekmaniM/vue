{"ast":null,"code":"import { createTextVNode as _createTextVNode, mergeProps as _mergeProps, createVNode as _createVNode, Fragment as _Fragment } from \"vue\"; // Styles\n\nimport \"./VSelect.css\"; // Components\n\nimport { VDialogTransition } from \"../transitions/index.mjs\";\nimport { VCheckboxBtn } from \"../VCheckbox/index.mjs\";\nimport { VChip } from \"../VChip/index.mjs\";\nimport { VDefaultsProvider } from \"../VDefaultsProvider/index.mjs\";\nimport { VList, VListItem } from \"../VList/index.mjs\";\nimport { VMenu } from \"../VMenu/index.mjs\";\nimport { VTextField } from \"../VTextField/index.mjs\"; // Composables\n\nimport { makeItemsProps, useItems } from \"../../composables/items.mjs\";\nimport { makeTransitionProps } from \"../../composables/transition.mjs\";\nimport { forwardRefs } from \"../../composables/forwardRefs.mjs\";\nimport { useLocale } from \"../../composables/locale.mjs\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.mjs\";\nimport { IconValue } from \"../../composables/icons.mjs\"; // Utility\n\nimport { computed, mergeProps, ref } from 'vue';\nimport { genericComponent, propsFactory, useRender, wrapInArray } from \"../../util/index.mjs\"; // Types\n\nexport const makeSelectProps = propsFactory({\n  chips: Boolean,\n  closableChips: Boolean,\n  eager: Boolean,\n  hideNoData: Boolean,\n  hideSelected: Boolean,\n  menu: Boolean,\n  menuIcon: {\n    type: IconValue,\n    default: '$dropdown'\n  },\n  menuProps: {\n    type: Object\n  },\n  modelValue: {\n    type: null,\n    default: () => []\n  },\n  multiple: Boolean,\n  noDataText: {\n    type: String,\n    default: '$vuetify.noDataText'\n  },\n  openOnClear: Boolean,\n  ...makeItemsProps({\n    itemChildren: false\n  })\n}, 'select');\nexport const VSelect = genericComponent()({\n  name: 'VSelect',\n  props: { ...makeSelectProps(),\n    ...makeTransitionProps({\n      transition: {\n        component: VDialogTransition\n      }\n    })\n  },\n  emits: {\n    'update:modelValue': val => true,\n    'update:menu': val => true\n  },\n\n  setup(props, _ref) {\n    let {\n      slots\n    } = _ref;\n    const {\n      t\n    } = useLocale();\n    const vTextFieldRef = ref();\n    const menu = useProxiedModel(props, 'menu');\n    const {\n      items,\n      transformIn,\n      transformOut\n    } = useItems(props);\n    const model = useProxiedModel(props, 'modelValue', [], v => transformIn(wrapInArray(v)), v => {\n      var _transformed$;\n\n      const transformed = transformOut(v);\n      return props.multiple ? transformed : (_transformed$ = transformed[0]) != null ? _transformed$ : null;\n    });\n    const selections = computed(() => {\n      return model.value.map(v => {\n        return items.value.find(item => item.value === v.value) || v;\n      });\n    });\n    const selected = computed(() => selections.value.map(selection => selection.props.value));\n\n    function onClear(e) {\n      model.value = [];\n\n      if (props.openOnClear) {\n        menu.value = true;\n      }\n    }\n\n    function onClickControl() {\n      if (props.hideNoData && !items.value.length) return;\n      menu.value = !menu.value;\n    }\n\n    function onKeydown(e) {\n      if (['Enter', 'ArrowDown', ' '].includes(e.key)) {\n        menu.value = true;\n      }\n\n      if (['Escape', 'Tab'].includes(e.key)) {\n        menu.value = false;\n      }\n    }\n\n    function select(item) {\n      if (props.multiple) {\n        const index = selected.value.findIndex(selection => selection === item.value);\n\n        if (index === -1) {\n          model.value = [...model.value, item];\n        } else {\n          const value = [...model.value];\n          value.splice(index, 1);\n          model.value = value;\n        }\n      } else {\n        model.value = [item];\n        menu.value = false;\n      }\n    }\n\n    useRender(() => {\n      const hasChips = !!(props.chips || slots.chip);\n      return _createVNode(VTextField, {\n        \"ref\": vTextFieldRef,\n        \"modelValue\": model.value.map(v => v.props.value).join(', '),\n        \"onUpdate:modelValue\": v => {\n          if (v == null) model.value = [];\n        },\n        \"validationValue\": props.modelValue,\n        \"class\": ['v-select', {\n          'v-select--active-menu': menu.value,\n          'v-select--chips': !!props.chips,\n          [`v-select--${props.multiple ? 'multiple' : 'single'}`]: true\n        }],\n        \"appendInnerIcon\": props.menuIcon,\n        \"readonly\": true,\n        \"onClick:clear\": onClear,\n        \"onClick:control\": onClickControl,\n        \"onBlur\": () => menu.value = false,\n        \"onKeydown\": onKeydown\n      }, { ...slots,\n        default: () => {\n          var _slots$noData, _slots$noData2, _slots$prependItem, _slots$appendItem;\n\n          return _createVNode(_Fragment, null, [_createVNode(VMenu, _mergeProps({\n            \"modelValue\": menu.value,\n            \"onUpdate:modelValue\": $event => menu.value = $event,\n            \"activator\": \"parent\",\n            \"contentClass\": \"v-select__content\",\n            \"eager\": props.eager,\n            \"openOnClick\": false,\n            \"closeOnContentClick\": false,\n            \"transition\": props.transition\n          }, props.menuProps), {\n            default: () => [_createVNode(VList, {\n              \"selected\": selected.value,\n              \"selectStrategy\": props.multiple ? 'independent' : 'single-independent',\n              \"onMousedown\": e => e.preventDefault()\n            }, {\n              default: () => [!items.value.length && !props.hideNoData && ((_slots$noData = (_slots$noData2 = slots['no-data']) == null ? void 0 : _slots$noData2.call(slots)) != null ? _slots$noData : _createVNode(VListItem, {\n                \"title\": t(props.noDataText)\n              }, null)), (_slots$prependItem = slots['prepend-item']) == null ? void 0 : _slots$prependItem.call(slots), items.value.map((item, index) => {\n                var _slots$item, _slots$item2;\n\n                return (_slots$item = (_slots$item2 = slots.item) == null ? void 0 : _slots$item2.call(slots, {\n                  item,\n                  index,\n                  props: mergeProps(item.props, {\n                    onClick: () => select(item)\n                  })\n                })) != null ? _slots$item : _createVNode(VListItem, _mergeProps({\n                  \"key\": index\n                }, item.props, {\n                  \"onClick\": () => select(item)\n                }), {\n                  prepend: _ref2 => {\n                    let {\n                      isSelected\n                    } = _ref2;\n                    return props.multiple && !props.hideSelected ? _createVNode(VCheckboxBtn, {\n                      \"modelValue\": isSelected,\n                      \"ripple\": false\n                    }, null) : undefined;\n                  }\n                });\n              }), (_slots$appendItem = slots['append-item']) == null ? void 0 : _slots$appendItem.call(slots)]\n            })]\n          }), selections.value.map((item, index) => {\n            function onChipClose(e) {\n              e.stopPropagation();\n              e.preventDefault();\n              select(item);\n            }\n\n            const slotProps = {\n              'onClick:close': onChipClose,\n              modelValue: true\n            };\n            return _createVNode(\"div\", {\n              \"key\": index,\n              \"class\": \"v-select__selection\"\n            }, [hasChips ? _createVNode(VDefaultsProvider, {\n              \"defaults\": {\n                VChip: {\n                  closable: props.closableChips,\n                  size: 'small',\n                  text: item.title\n                }\n              }\n            }, {\n              default: () => [slots.chip ? slots.chip({\n                item,\n                index,\n                props: slotProps\n              }) : _createVNode(VChip, slotProps, null)]\n            }) : slots.selection ? slots.selection({\n              item,\n              index\n            }) : _createVNode(\"span\", {\n              \"class\": \"v-select__selection-text\"\n            }, [item.title, props.multiple && index < selections.value.length - 1 && _createVNode(\"span\", {\n              \"class\": \"v-select__selection-comma\"\n            }, [_createTextVNode(\",\")])])]);\n          })]);\n        }\n      });\n    });\n    return forwardRefs({\n      menu,\n      select\n    }, vTextFieldRef);\n  }\n\n});","map":{"version":3,"mappings":"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","names":["VDialogTransition","VCheckboxBtn","VChip","VDefaultsProvider","VList","VListItem","VMenu","VTextField","makeItemsProps","useItems","makeTransitionProps","forwardRefs","useLocale","useProxiedModel","IconValue","computed","mergeProps","ref","genericComponent","propsFactory","useRender","wrapInArray","makeSelectProps","chips","Boolean","closableChips","eager","hideNoData","hideSelected","menu","menuIcon","type","default","menuProps","Object","modelValue","multiple","noDataText","String","openOnClear","itemChildren","VSelect","name","props","transition","component","emits","val","setup","slots","_ref","t","vTextFieldRef","items","transformIn","transformOut","model","v","transformed","selections","value","map","find","item","selected","selection","onClear","e","onClickControl","length","onKeydown","includes","key","select","index","findIndex","splice","hasChips","chip","join","$event","preventDefault","_slots$noData2","_slots$prependItem","_slots$item2","onClick","prepend","_ref2","isSelected","undefined","_slots$appendItem","onChipClose","stopPropagation","slotProps","closable","size","text","title"],"sources":["../../../src/components/VSelect/VSelect.tsx"],"sourcesContent":["// Styles\nimport './VSelect.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VCheckboxBtn } from '@/components/VCheckbox'\nimport { VChip } from '@/components/VChip'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VList, VListItem } from '@/components/VList'\nimport { VMenu } from '@/components/VMenu'\nimport { VTextField } from '@/components/VTextField'\n\n// Composables\nimport { makeItemsProps, useItems } from '@/composables/items'\nimport { makeTransitionProps } from '@/composables/transition'\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useLocale } from '@/composables/locale'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { IconValue } from '@/composables/icons'\n\n// Utility\nimport { computed, mergeProps, ref } from 'vue'\nimport { genericComponent, propsFactory, useRender, wrapInArray } from '@/util'\n\n// Types\nimport type { VInputSlots } from '@/components/VInput/VInput'\nimport type { VFieldSlots } from '@/components/VField/VField'\nimport type { InternalItem } from '@/composables/items'\nimport type { MakeSlots } from '@/util'\nimport type { PropType } from 'vue'\n\nexport const makeSelectProps = propsFactory({\n  chips: Boolean,\n  closableChips: Boolean,\n  eager: Boolean,\n  hideNoData: Boolean,\n  hideSelected: Boolean,\n  menu: Boolean,\n  menuIcon: {\n    type: IconValue,\n    default: '$dropdown',\n  },\n  menuProps: {\n    type: Object as PropType<VMenu['$props']>,\n  },\n  modelValue: {\n    type: null,\n    default: () => ([]),\n  },\n  multiple: Boolean,\n  noDataText: {\n    type: String,\n    default: '$vuetify.noDataText',\n  },\n  openOnClear: Boolean,\n\n  ...makeItemsProps({ itemChildren: false }),\n}, 'select')\n\ntype Primitive = string | number | boolean | symbol\n\ntype Val <T, ReturnObject extends boolean> = T extends Primitive\n  ? T\n  : (ReturnObject extends true ? T : any)\n\ntype Value <T, ReturnObject extends boolean, Multiple extends boolean> =\n  Multiple extends true\n    ? Val<T, ReturnObject>[]\n    : Val<T, ReturnObject>\n\nexport const VSelect = genericComponent<new <\n  T,\n  ReturnObject extends boolean = false,\n  Multiple extends boolean = false,\n  V extends Value<T, ReturnObject, Multiple> = Value<T, ReturnObject, Multiple>\n>() => {\n  $props: {\n    items?: readonly T[]\n    returnObject?: ReturnObject\n    multiple?: Multiple\n    modelValue?: Readonly<V>\n    'onUpdate:modelValue'?: (val: V) => void\n  }\n  $slots: Omit<VInputSlots & VFieldSlots, 'default'> & MakeSlots<{\n    item: [{ item: T, index: number, props: Record<string, unknown> }]\n    chip: [{ item: T, index: number, props: Record<string, unknown> }]\n    selection: [{ item: T, index: number }]\n    'no-data': []\n  }>\n}>()({\n  name: 'VSelect',\n\n  props: {\n    ...makeSelectProps(),\n    ...makeTransitionProps({ transition: { component: VDialogTransition } }),\n  },\n\n  emits: {\n    'update:modelValue': (val: any) => true,\n    'update:menu': (val: boolean) => true,\n  },\n\n  setup (props, { slots }) {\n    const { t } = useLocale()\n    const vTextFieldRef = ref<VTextField>()\n    const menu = useProxiedModel(props, 'menu')\n    const { items, transformIn, transformOut } = useItems(props)\n    const model = useProxiedModel(\n      props,\n      'modelValue',\n      [],\n      v => transformIn(wrapInArray(v)),\n      v => {\n        const transformed = transformOut(v)\n        return props.multiple ? transformed : (transformed[0] ?? null)\n      }\n    )\n    const selections = computed(() => {\n      return model.value.map(v => {\n        return items.value.find(item => item.value === v.value) || v\n      })\n    })\n    const selected = computed(() => selections.value.map(selection => selection.props.value))\n\n    function onClear (e: MouseEvent) {\n      model.value = []\n\n      if (props.openOnClear) {\n        menu.value = true\n      }\n    }\n    function onClickControl () {\n      if (props.hideNoData && !items.value.length) return\n\n      menu.value = !menu.value\n    }\n    function onKeydown (e: KeyboardEvent) {\n      if (['Enter', 'ArrowDown', ' '].includes(e.key)) {\n        menu.value = true\n      }\n\n      if (['Escape', 'Tab'].includes(e.key)) {\n        menu.value = false\n      }\n    }\n    function select (item: InternalItem) {\n      if (props.multiple) {\n        const index = selected.value.findIndex(selection => selection === item.value)\n\n        if (index === -1) {\n          model.value = [...model.value, item]\n        } else {\n          const value = [...model.value]\n          value.splice(index, 1)\n          model.value = value\n        }\n      } else {\n        model.value = [item]\n        menu.value = false\n      }\n    }\n\n    useRender(() => {\n      const hasChips = !!(props.chips || slots.chip)\n\n      return (\n        <VTextField\n          ref={ vTextFieldRef }\n          modelValue={ model.value.map(v => v.props.value).join(', ') }\n          onUpdate:modelValue={ v => { if (v == null) model.value = [] } }\n          validationValue={ props.modelValue }\n          class={[\n            'v-select',\n            {\n              'v-select--active-menu': menu.value,\n              'v-select--chips': !!props.chips,\n              [`v-select--${props.multiple ? 'multiple' : 'single'}`]: true,\n            },\n          ]}\n          appendInnerIcon={ props.menuIcon }\n          readonly\n          onClick:clear={ onClear }\n          onClick:control={ onClickControl }\n          onBlur={ () => menu.value = false }\n          onKeydown={ onKeydown }\n        >\n          {{\n            ...slots,\n            default: () => (\n              <>\n                <VMenu\n                  v-model={ menu.value }\n                  activator=\"parent\"\n                  contentClass=\"v-select__content\"\n                  eager={ props.eager }\n                  openOnClick={ false }\n                  closeOnContentClick={ false }\n                  transition={ props.transition }\n                  { ...props.menuProps }\n                >\n                  <VList\n                    selected={ selected.value }\n                    selectStrategy={ props.multiple ? 'independent' : 'single-independent' }\n                    onMousedown={ (e: MouseEvent) => e.preventDefault() }\n                  >\n                    { !items.value.length && !props.hideNoData && (slots['no-data']?.() ?? (\n                      <VListItem title={ t(props.noDataText) } />\n                    )) }\n\n                    { slots['prepend-item']?.() }\n\n                    { items.value.map((item, index) => slots.item?.({\n                      item,\n                      index,\n                      props: mergeProps(item.props, { onClick: () => select(item) }),\n                    }) ?? (\n                      <VListItem\n                        key={ index }\n                        { ...item.props }\n                        onClick={ () => select(item) }\n                      >\n                        {{\n                          prepend: ({ isSelected }) => props.multiple && !props.hideSelected ? (\n                            <VCheckboxBtn modelValue={ isSelected } ripple={ false } />\n                          ) : undefined,\n                        }}\n                      </VListItem>\n                    )) }\n\n                    { slots['append-item']?.() }\n                  </VList>\n                </VMenu>\n\n                { selections.value.map((item, index) => {\n                  function onChipClose (e: Event) {\n                    e.stopPropagation()\n                    e.preventDefault()\n\n                    select(item)\n                  }\n\n                  const slotProps = {\n                    'onClick:close': onChipClose,\n                    modelValue: true,\n                  }\n\n                  return (\n                    <div key={ index } class=\"v-select__selection\">\n                      { hasChips ? (\n                        <VDefaultsProvider\n                          defaults={{\n                            VChip: {\n                              closable: props.closableChips,\n                              size: 'small',\n                              text: item.title,\n                            },\n                          }}\n                        >\n                          { slots.chip\n                            ? slots.chip({ item, index, props: slotProps })\n                            : (<VChip { ...slotProps } />)\n                          }\n                        </VDefaultsProvider>\n                      ) : (\n                        slots.selection\n                          ? slots.selection({ item, index })\n                          : (\n                            <span class=\"v-select__selection-text\">\n                              { item.title }\n                              { props.multiple && (index < selections.value.length - 1) && (\n                                <span class=\"v-select__selection-comma\">,</span>\n                              ) }\n                            </span>\n                          )\n                      )}\n                    </div>\n                  )\n                }) }\n              </>\n            ),\n          }}\n        </VTextField>\n      )\n    })\n\n    return forwardRefs({\n      menu,\n      select,\n    }, vTextFieldRef)\n  },\n})\n\nexport type VSelect = InstanceType<typeof VSelect>\n"]},"metadata":{},"sourceType":"module"}